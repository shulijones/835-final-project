<script src="https://unpkg.com/vue@3"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>


<div id="app">
  {{ message }}
  {{ speech }}
  {{ mode }}
  <img src="http://localhost:8080/api/video_feed">
  <img :src=single_image>
</div>

<script>
  Vue.createApp({
    data() {
      return {
        message: 'Hello Vue!',
        speech: '[Your speech here]',
        single_image: "http://localhost:8080/api/video_feed",
        mode: 'default'
      }
    },
    methods: {
    },
    mounted() {
      var recognition = new webkitSpeechRecognition();
      recognition.continuous = true;
      recognition.interimResults = true;
      recognition.onresult = (event) => { 
        // note: arrow function syntax is crucial so that 'this' keeps larger scope
        this.speech = event.results[event.results.length-1][0].transcript;

        if (this.speech.includes("color")){
          this.mode = "color"
        } else if (this.speech.includes("default"))
          this.mode = "default"
      }
      recognition.onend = function(event) {
        setTimeout(function() {
          recognition.start();
        }, 1000);
      };
      recognition.start();

      axios.get('http://localhost:8080/api/current_image')
        .then((response) => {
          this.single_image = "data:image/jpg;base64," + response.data
        })
        .catch((error) => {
         console.log(error)
        });
    }
  }).mount('#app')
</script>